%Hechos

%##########################################################
%Escenas validos de 5X10 con 2, 4 y 6 enemigos
scene([5,10,2,0,0,
     [["0","0","0","0","0","0","0","0","0","0"]
     ,["0","0","0","0","0","0","0","0","0","0"]
     ,["1","1","0","0","0","0","0","0","2","2"]
     ,["#","#","#","#","#","#","#","#","#","#"]
     ,["#","#","#","#","#","#","#","#","#","#"]]]).

scene([5,10,4,0,0,
     [["0","0","0","0","0","0","0","0","0","0"]
     ,["0","0","0","0","0","0","0","0","0","0"]
     ,["1","1","1","1","0","0","2","2","2","2"]
     ,["#","#","#","#","#","#","#","#","#","#"]
     ,["#","#","#","#","#","#","#","#","#","#"]]]).



scene([5,10,5,0,0,
     [["0","0","0","0","0","0","0","0","0","0"]
     ,["0","0","0","0","0","0","0","0","0","0"]
     ,["1","1","1","1","1","2","2","2","2","2"]
     ,["#","#","#","#","#","#","#","#","#","#"]
     ,["#","#","#","#","#","#","#","#","#","#"]]]).


%##########################################################
%Escenas validos de 10X12 con 4 y 6 enemigos

scene([10,12,4,0,0,
     [["0","0","0","0","0","0","0","0","0","0","0","0"]
     ,["0","0","0","0","0","0","0","0","0","0","0","0"]
     ,["0","0","0","0","0","0","0","0","0","0","0","0"]
     ,["0","0","0","0","0","0","0","0","0","0","0","0"]
     ,["0","0","0","0","0","0","0","0","0","0","0","0"]
     ,["0","0","0","0","0","0","0","0","0","0","0","0"]
     ,["0","0","0","0","0","0","0","0","0","0","0","0"]
     ,["1","1","1","1","0","0","0","0","2","2","2","2"]
     ,["#","#","#","#","#","#","#","#","#","#","#","#"]
     ,["#","#","#","#","#","#","#","#","#","#","#","#"]]]).

scene([10,12,6,0,0,
     [["0","0","0","0","0","0","0","0","0","0","0","0"]
     ,["0","0","0","0","0","0","0","0","0","0","0","0"]
     ,["0","0","0","0","0","0","0","0","0","0","0","0"]
     ,["0","0","0","0","0","0","0","0","0","0","0","0"]
     ,["0","0","0","0","0","0","0","0","0","0","0","0"]
     ,["0","0","0","0","0","0","0","0","0","0","0","0"]
     ,["0","0","0","0","0","0","0","0","0","0","0","0"]
     ,["1","1","1","1","1","1","2","2","2","2","2","2"]
     ,["#","#","#","#","#","#","#","#","#","#","#","#"]
     ,["#","#","#","#","#","#","#","#","#","#","#","#"]]]).


%##########################################################
%Escenas validos de 20X20 con 8 enemigos

scene([20,20,8,0,0,
     [["0","0","0","0","0","0","0","0","0","0","0","0","0","0","0","0","0","0","0","0"]
     ,["0","0","0","0","0","0","0","0","0","0","0","0","0","0","0","0","0","0","0","0"]
     ,["0","0","0","0","0","0","0","0","0","0","0","0","0","0","0","0","0","0","0","0"]
     ,["0","0","0","0","0","0","0","0","0","0","0","0","0","0","0","0","0","0","0","0"]
     ,["0","0","0","0","0","0","0","0","0","0","0","0","0","0","0","0","0","0","0","0"]
     ,["0","0","0","0","0","0","0","0","0","0","0","0","0","0","0","0","0","0","0","0"]
     ,["0","0","0","0","0","0","0","0","0","0","0","0","0","0","0","0","0","0","0","0"]
     ,["0","0","0","0","0","0","0","0","0","0","0","0","0","0","0","0","0","0","0","0"]
     ,["0","0","0","0","0","0","0","0","0","0","0","0","0","0","0","0","0","0","0","0"]
     ,["0","0","0","0","0","0","0","0","0","0","0","0","0","0","0","0","0","0","0","0"]
     ,["0","0","0","0","0","0","0","0","0","0","0","0","0","0","0","0","0","0","0","0"]
     ,["0","0","0","0","0","0","0","0","0","0","0","0","0","0","0","0","0","0","0","0"]
     ,["0","0","0","0","0","0","0","0","0","0","0","0","0","0","0","0","0","0","0","0"]
     ,["0","0","0","0","0","0","0","0","0","0","0","0","0","0","0","0","0","0","0","0"]
     ,["0","0","0","0","0","0","0","0","0","0","0","0","0","0","0","0","0","0","0","0"]
     ,["0","0","0","0","0","0","0","0","0","0","0","0","0","0","0","0","0","0","0","0"]
     ,["0","0","0","0","0","0","0","0","0","0","0","0","0","0","0","0","0","0","0","0"]
     ,["1","1","1","1","1","1","1","1","0","0","0","0","2","2","2","2","2","2","2","2"]
     ,["#","#","#","#","#","#","#","#","#","#","#","#","#","#","#","#","#","#","#","#"]
     ,["#","#","#","#","#","#","#","#","#","#","#","#","#","#","#","#","#","#","#","#"]]]).


%##########################################################
%Reglas


%#############################################
%Funciones Getters

getAlto(SCENE,ELEM):- % N
    nth0(0,SCENE,ELEM).

getAncho(SCENE, ELEM):- % M
    nth0(1,SCENE,ELEM).

getEnemigos(SCENE,ELEM):- % E
    nth0(2,SCENE,ELEM).

getDif(SCENE,ELEM):- % D
    nth0(3,SCENE,ELEM).

getSeed(SCENE,ELEM):- % SEED
    nth0(4,SCENE,ELEM).

getScene(SCENE,ELEM):- % SCENE
    nth0(5,SCENE,ELEM).

getFila(MATRIZ, F, ELEM):-
    %getSpace(SPACE, MATRIZ),
    nth0(F, MATRIZ, ELEM).

%Ejemplos:
% Los ejemplos aqui puestos no estan sujetos a las restricciones del
% enunciado

%getAlto([2,3,2,0,0,[["0","0","0"],["0","0","0"]]],ELEM).
%getAlto([2,5,2,0,0,[["0","0","0","0","0"],["0","0","0","0","0"]]],ELEM).
%getAlto([2,2,2,0,0,[["0","0"],["0","0"]]],ELEM).

%getAncho([2,3,2,0,0,["0","0","0"],["0","0","0"]],ELEM).
%getAncho([3,3,3,0,0,["0","0","0"],["0","0","0"],["0","0","0"],ELEM).
%getAncho([4,3,2,0,0,["0","0","0"],["0","0","0"],["0","0","0"],["0","0","0"]],ELEM).

%getEnemigos[2,3,2,0,0,[["0","2","2"],["#","#","#"]]],ELEM).
%getEnemigos[2,3,4,0,0,[[""",""",""","2"],["#","#","#","#"]]],ELEM).
%getEnemigos[4,3,2,0,0,[["0","0","0"],["0","0","0"],["0","2","2"],["#","#","#"]]],ELEM).

%getDif([2,3,2,0,0,[["0","0","0"],["0","0","0"]]],ELEM).
%getDif([2,5,2,0,0,[["0","0","0","0","0"],["0","0","0","0","0"]]],ELEM).
%getDif([2,2,2,0,0,[["0","0"],["0","0"]]],ELEM).

%getSeed([2,3,2,0,0,[["0","0","0"],["0","0","0"]]],ELEM).
%getSeed([2,5,2,0,0,[["0","0","0","0","0"],["0","0","0","0","0"]]],ELEM).
%getSeed([2,2,2,0,0,[["0","0"],["0","0"]]],ELEM).

%getScene([2,3,2,0,0,[["1","0","2"],["#","#","#"]]],ELEM).
%getScene([2,3,4,0,0,[["0","2","0"],["#","#","#"]]],ELEM).
%getScene([2,3,2,0,0,[["0","1","1"],["#","#","#"]]],ELEM).

%getFila([["1","0","2"],["#","#","#"]], 0, ELEM).
%getFila([["0","2","0"],["#","#","#"]], 1, ELEM).
%getFila([["0","0","0"],["0","1","1"],["#","#","#"]], 2, ELEM).


%#############################################


%#############################################
%Funcion que calcula las columnas de una matriz.
%sizeColumnas debe recibir una lista.
sizeColumnas([],0).

sizeColumnas([_|Xs],N):-
    sizeColumnas(Xs, N1),
    N is N1 +1.

% ya que "sizeColumnas" es una funcion puente, sus ejemplos estan en
% "size"

%#############################################


%#############################################
%Funcion que calcula las filas de una matriz.
%sizeFilas debe recibir una matriz.
sizeFilas([], 0).

sizeFilas([_|Xs],N):-
    sizeFilas(Xs, N1),
    N is N1 + 1.

% ya que "sizeFilas" es una funcion puente, sus ejemplos estan en
% "size"

%#############################################

%#############################################
% Funcion que junta sizeColumnas y sizeFilas y devuelve ambas medidas en
% N y M respectivamente.
size([X|Xs], N, M):-
    MATRIZ = [X|Xs],
    sizeColumnas(X, M),
    sizeFilas(MATRIZ, N).

%Ejemplos:
%size([[1,2],[3,4]], 2, 2).
%size([[1,2,3]], 3, 1).
%size([[1,2],[3,4],[5,7]], 2, 2).

%#############################################



%#############################################
% Funcion que verifica que los valores dados cumplan con las
% especificaciones pedidas.
isScene(N, M, E, ENEMIGOS, MATRIZ):-
    N >= 5,
    M >= 10,
    E = ENEMIGOS,
    size(MATRIZ, NAUX, MAUX),
    NAUX == N,
    MAUX == M.

% Debido a que isSpace es una funcion puente de checkSpace, los ejemplos
% seran puestos en dicha funcion

%#############################################

%#############################################
% Funcion que cuenta los enemigos en un tablero

contarEnemigos([],CONT,CONT).

contarEnemigos([X|Xs], CONT, OUT):-
    X \= "2",
    contarEnemigos(Xs, CONT,OUT).


contarEnemigos([X|Xs], CONT,OUT):-
    X == "2",
    CONT1 is CONT + 1,
    contarEnemigos(Xs, CONT1,OUT).

contarEnemigos([], E, E).

contarEnemigos([M|Ms], E, CONT):-
    contarEnemigos(M, 0,CONT1),
    CONT2 is CONT1 + CONT,
    contarEnemigos(Ms, E, CONT2).



%#############################################
%Funcion que me dice si la escena es valida o no,
%chequea si el ancho y alto son validos segun las medidas puestas,
%cuenta la cantidad de enemigos en el espacio y lo compara con
%la informacion en el TDA.

checkScene([N,M,E,_, _, _]):-
    scene([N, M, ENEMIGOS, 0, 0, MATRIZ]),
    isScene( N, M, E, ENEMIGOS, MATRIZ),
    contarEnemigos(MATRIZ, E, 0).

%Ejemplos:
%isScene([5, 10, 4, _]).
%isScene([10, 12, 4, _]).
%isScene([20, 20, 8, _]).

%#############################################


%#############################################
% Funcion que busca entre los hechos, la escena con las caracteristicas
% pedidas, ademas valida si todos los datos son correctos.

createScene(N, M, E, _, _, _, SCENE):-  % D, SEED
    scene([N, M, E, 0, 0, MATRIZ]),
    checkScene([N, M, E, 0, 0, MATRIZ]),
    SCENE = [N, M, E, 0, 0, MATRIZ].
    %Swrite(SPACE).
    %imprimir(SPACE).

%Ejemplos:
%createScene(5,10,2,_,_,_,OUT).
%createScene(10,12,6,_,_,_,OUT).
%createScene(20,20,8,_,_,_,OUT).

%#############################################
